# ğŸ¥ ESP32-S3 æ‘„åƒå¤´å‰ç«¯é›†æˆå®Œæˆï¼

## âœ… å·²å®Œæˆçš„å·¥ä½œ

æˆ‘å·²ç»åœ¨ä½ çš„å‰ç«¯æ·»åŠ äº†ä¸€ä¸ªå…¨æ–°çš„ **ESP32CameraPanel** ç»„ä»¶ï¼Œå¯ä»¥ç›´æ¥åœ¨ç½‘é¡µä¸ŠæŸ¥çœ‹å’Œæ‹æ‘„ ESP32-S3 æ‘„åƒå¤´ï¼

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•ï¼ˆ3 æ­¥ï¼‰

### **æ­¥éª¤ 1ï¼šå¯åŠ¨å‰åç«¯æœåŠ¡**

```bash
cd /Users/meaqua/Desktop/EE3070

# ç»ˆç«¯ 1ï¼šå¯åŠ¨åç«¯
cd smart-cat-backend
npm run dev
# æˆ–
npm run build && npm start

# ç»ˆç«¯ 2ï¼šå¯åŠ¨å‰ç«¯
cd smart-cat-home
npm run dev
```

### **æ­¥éª¤ 2ï¼šè¿æ¥åˆ° ESP32 WiFi**

```bash
# Mac: æ‰“å¼€ WiFi è®¾ç½®
# è¿æ¥åˆ° "ESP32-CAM" çƒ­ç‚¹

# æˆ–ä½¿ç”¨ç®¡ç†è„šæœ¬
bash manage-esp32-wifi.sh
# é€‰æ‹© "1. è¿æ¥åˆ° ESP32-S3 CAM WiFi"
```

### **æ­¥éª¤ 3ï¼šæ‰“å¼€æµè§ˆå™¨**

```bash
open http://localhost:5173
```

**å°±è¿™ä¹ˆç®€å•ï¼** ğŸ‰

ä½ ä¼šåœ¨é¡µé¢ä¸Šçœ‹åˆ°ä¸€ä¸ªæ–°çš„ "ESP32-S3 æ‘„åƒå¤´" é¢æ¿ï¼Œå¯ä»¥ï¼š
- ğŸ“· ç‚¹å‡»æŒ‰é’®æ‹æ‘„ç…§ç‰‡
- ğŸ”„ å¯ç”¨è‡ªåŠ¨åˆ·æ–°ï¼ˆæ¯ 5 ç§’æ›´æ–°ï¼‰
- ğŸ’¾ ä¸‹è½½ä¿å­˜ç…§ç‰‡
- ğŸ”— æ‰“å¼€ ESP32 å®Œæ•´ç•Œé¢

---

## ğŸ¨ åŠŸèƒ½ç‰¹æ€§

### âœ… **æ™ºèƒ½è¿æ¥æ£€æµ‹**
- è‡ªåŠ¨æ£€æµ‹æ˜¯å¦è¿æ¥åˆ° ESP32 WiFi
- å®æ—¶æ˜¾ç¤ºè¿æ¥çŠ¶æ€ï¼ˆåœ¨çº¿/ç¦»çº¿ï¼‰
- æä¾›è¿æ¥æŒ‡å—

### âœ… **å®æ—¶æ‹æ‘„**
- ç‚¹å‡»æŒ‰é’®å³å¯æ‹æ‘„ç…§ç‰‡
- è‡ªåŠ¨åˆ·æ–°æ¨¡å¼ï¼ˆå¯é€‰ï¼‰
- æ˜¾ç¤ºæœ€åæ‹æ‘„æ—¶é—´

### âœ… **å¤šç«¯ç‚¹æ”¯æŒ**
è‡ªåŠ¨å°è¯•ä»¥ä¸‹ç«¯ç‚¹ï¼š
- `/capture` ï¼ˆæœ€å¸¸è§ï¼‰
- `/snapshot` ï¼ˆå¤‡é€‰ï¼‰
- `/cam.jpg` ï¼ˆå…¼å®¹æŸäº›å›ºä»¶ï¼‰

### âœ… **å‹å¥½çš„ç”¨æˆ·ç•Œé¢**
- å¤§æŒ‰é’®ï¼Œæ˜“äºç‚¹å‡»
- å®æ—¶çŠ¶æ€æŒ‡ç¤ºå™¨ï¼ˆğŸ”´ ç¦»çº¿ / ğŸŸ¢ åœ¨çº¿ï¼‰
- è¯¦ç»†çš„é”™è¯¯æç¤ºå’Œæ•…éšœæ’é™¤
- ç…§ç‰‡ä¸‹è½½åŠŸèƒ½

### âœ… **å®Œå…¨ç‹¬ç«‹**
- ä¸ä¾èµ–åç«¯ä»£ç†
- ç›´æ¥ä» ESP32 è·å–ç…§ç‰‡
- localhost æœåŠ¡ä¸å—å½±å“

---

## ğŸ“‹ ç•Œé¢é¢„è§ˆ

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ğŸŸ¢ ESP32-S3 æ‘„åƒå¤´                                â•‘
â•‘  ESP32 åœ¨çº¿ Â· æœ€åæ›´æ–°: 14:23:45                  â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚ [ ] è‡ªåŠ¨åˆ·æ–° (5s)                          â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                    â•‘
â•‘  [ğŸ“· æ‹æ‘„ç…§ç‰‡] [ğŸ’¾ ä¸‹è½½ç…§ç‰‡] [ğŸ”— æ‰“å¼€å®Œæ•´ç•Œé¢]   â•‘
â•‘                                                    â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚                                              â”‚  â•‘
â•‘  â”‚         [æ‘„åƒå¤´ç…§ç‰‡æ˜¾ç¤ºåŒºåŸŸ]                â”‚  â•‘
â•‘  â”‚                                              â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                    â•‘
â•‘  ğŸ’¡ ä½¿ç”¨æç¤ºï¼š                                    â•‘
â•‘  â€¢ ç¡®ä¿å·²è¿æ¥åˆ° ESP32-CAM WiFi                   â•‘
â•‘  â€¢ localhost æœåŠ¡ä»ç„¶å¯ç”¨                        â•‘
â•‘  â€¢ æ‹æ‘„çš„ç…§ç‰‡å¯ä»¥ä¸‹è½½ä¿å­˜                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## ğŸ”§ é…ç½®é€‰é¡¹

### **ä¿®æ”¹ ESP32 åœ°å€**

å¦‚æœä½ çš„ ESP32 ä½¿ç”¨ä¸åŒçš„ IP åœ°å€ï¼Œç¼–è¾‘ç»„ä»¶ï¼š

```bash
nano /Users/meaqua/Desktop/EE3070/smart-cat-home/src/components/ESP32CameraPanel.tsx
```

ä¿®æ”¹ç¬¬ 5 è¡Œï¼š
```typescript
const ESP32_BASE_URL = 'http://192.168.5.1'  // æ”¹ä¸ºä½ çš„ IP
```

### **ä¿®æ”¹ç«¯ç‚¹**

å¦‚æœä½ çš„ ESP32 ä½¿ç”¨ä¸åŒçš„ç«¯ç‚¹ï¼Œä¿®æ”¹ç¬¬ 6 è¡Œï¼š
```typescript
const ESP32_ENDPOINTS = ['/capture', '/snapshot', '/cam.jpg']
```

### **ä¿®æ”¹è‡ªåŠ¨åˆ·æ–°é—´éš”**

åœ¨ç»„ä»¶çš„ç¬¬ 101 è¡Œï¼š
```typescript
const interval = setInterval(() => {
  capturePhoto()
}, 5000) // æ”¹ä¸ºä½ æƒ³è¦çš„æ¯«ç§’æ•°
```

---

## ğŸ“± å®Œæ•´å·¥ä½œæµç¨‹

### **å¼€å‘æµç¨‹**

```bash
# 1. å®¶åº­ WiFi æ¨¡å¼ - å¼€å‘å’Œä¸Šç½‘
å¼€å‘ä»£ç  â†” ä½¿ç”¨äº’è”ç½‘ â†” æµ‹è¯•åŠŸèƒ½

# 2. ESP32 WiFi æ¨¡å¼ - æ‹æ‘„ç…§ç‰‡
æµè§ˆå™¨è®¿é—® localhost:5173 â†’ ç‚¹å‡»æ‹æ‘„ â†’ æŸ¥çœ‹ç…§ç‰‡

# 3. éšæ—¶åˆ‡æ¢
bash manage-esp32-wifi.sh
```

### **ä¸¤ç§ä½¿ç”¨æ¨¡å¼**

#### **æ¨¡å¼ Aï¼šæŒ‰éœ€æ‹æ‘„**
1. è¿æ¥å®¶åº­ WiFiï¼Œå¯åŠ¨æœåŠ¡
2. éœ€è¦æ‹ç…§æ—¶ï¼Œåˆ‡æ¢åˆ° ESP32 WiFi
3. æ‰“å¼€æµè§ˆå™¨ï¼Œç‚¹å‡»æ‹æ‘„
4. æ‹å®Œååˆ‡å›å®¶åº­ WiFi

#### **æ¨¡å¼ Bï¼šå®æ—¶ç›‘æ§**
1. è¿æ¥ ESP32 WiFi
2. å¯ç”¨"è‡ªåŠ¨åˆ·æ–°"
3. æ¯ 5 ç§’è‡ªåŠ¨æ›´æ–°ç…§ç‰‡
4. å®æ—¶ç›‘æ§çŒ«å’ªåŠ¨æ€

---

## ğŸ’» ä»£ç è¯´æ˜

### **ç»„ä»¶ä½ç½®**
```
/Users/meaqua/Desktop/EE3070/smart-cat-home/src/components/ESP32CameraPanel.tsx
```

### **ä¸»è¦åŠŸèƒ½**

```typescript
// 1. è¿æ¥æ£€æµ‹
checkConnection() // æ¯ 10 ç§’æ£€æµ‹ä¸€æ¬¡

// 2. è‡ªåŠ¨æŸ¥æ‰¾ç«¯ç‚¹
findWorkingEndpoint() // å°è¯• /capture, /snapshot, /cam.jpg

// 3. æ‹æ‘„ç…§ç‰‡
capturePhoto() // è·å–å¹¶æ˜¾ç¤ºç…§ç‰‡

// 4. è‡ªåŠ¨åˆ·æ–°
setAutoRefresh(true) // æ¯ 5 ç§’è‡ªåŠ¨æ‹æ‘„
```

### **å…³é”®ç‰¹æ€§**

1. **ç›´æ¥è®¿é—® ESP32**
   ```typescript
   fetch('http://192.168.5.1/capture')
   ```

2. **Blob URL ç®¡ç†**
   ```typescript
   const url = URL.createObjectURL(blob)
   URL.revokeObjectURL(oldUrl) // è‡ªåŠ¨æ¸…ç†
   ```

3. **é”™è¯¯å¤„ç†**
   ```typescript
   try {
     // æ‹æ‘„ç…§ç‰‡
   } catch (err) {
     setError(err.message)
     setIsConnected(false)
   }
   ```

---

## ğŸ› å¸¸è§é—®é¢˜

### **Q: ç»„ä»¶æ˜¾ç¤º"ESP32 ç¦»çº¿"**

**A:** æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
1. ESP32-S3 æ˜¯å¦å·²å¯åŠ¨ï¼Ÿ
2. WiFi æ˜¯å¦è¿æ¥åˆ° ESP32-CAMï¼Ÿ
3. åœ¨ç»ˆç«¯è¿è¡Œï¼š
   ```bash
   curl http://192.168.5.1
   ```
   å¦‚æœæˆåŠŸï¼Œè¯´æ˜ ESP32 æ­£å¸¸ï¼Œå¯èƒ½æ˜¯æµè§ˆå™¨ CORS é—®é¢˜ã€‚

### **Q: ç‚¹å‡»æ‹æ‘„æŒ‰é’®æ²¡æœ‰ååº”**

**A:** æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰ï¼ŒæŸ¥çœ‹é”™è¯¯ä¿¡æ¯ï¼š
- **CORS é”™è¯¯**ï¼šESP32 å›ºä»¶éœ€è¦æ·»åŠ  CORS å¤´
- **Network Error**ï¼šç¡®è®¤ WiFi è¿æ¥
- **Timeout**ï¼šESP32 å“åº”å¤ªæ…¢ï¼Œæ£€æŸ¥ç”µæº

### **Q: ç…§ç‰‡åŠ è½½å¾ˆæ…¢**

**A:** é™ä½ ESP32 ç…§ç‰‡è´¨é‡ï¼š
```cpp
// åœ¨ ESP32 å›ºä»¶ä¸­
config.jpeg_quality = 12;  // æ•°å­—è¶Šå¤§ï¼Œå‹ç¼©è¶Šå¤š
config.frame_size = FRAMESIZE_VGA;  // é™ä½åˆ†è¾¨ç‡
```

### **Q: èƒ½å¦åœ¨åç«¯ä¿å­˜ç…§ç‰‡ï¼Ÿ**

**A:** å¯ä»¥ï¼æ·»åŠ ä¸€ä¸ª"ä¸Šä¼ åˆ°åç«¯"æŒ‰é’®ï¼š

```typescript
const uploadToBackend = async () => {
  const response = await fetch(imageUrl)
  const blob = await response.blob()

  const formData = new FormData()
  formData.append('photo', blob, 'esp32-capture.jpg')

  await fetch('http://localhost:4000/api/upload-photo', {
    method: 'POST',
    body: formData
  })
}
```

---

## ğŸ¯ ä¸‹ä¸€æ­¥ä¼˜åŒ–å»ºè®®

### **1. æ·»åŠ å›¾åƒå¢å¼º**
```typescript
// äº®åº¦ã€å¯¹æ¯”åº¦è°ƒæ•´
<input type="range" onChange={adjustBrightness} />
```

### **2. æ·»åŠ æ‰‹åŠ¿æ§åˆ¶**
```typescript
// åŒå‡»æ”¾å¤§ã€æ»‘åŠ¨åˆ‡æ¢å†å²ç…§ç‰‡
<div onDoubleClick={zoomIn} onSwipe={showHistory}>
```

### **3. é›†æˆ AI åˆ†æ**
```typescript
// æ‹æ‘„åè‡ªåŠ¨å‘é€åˆ°åç«¯è¿›è¡ŒçŒ«å’ªæ£€æµ‹
const analyzePhoto = async () => {
  await fetch('http://localhost:4000/api/analyze-image', {
    method: 'POST',
    body: blob
  })
}
```

### **4. æ·»åŠ ç…§ç‰‡å†å²**
```typescript
// ä¿å­˜æœ€è¿‘ 10 å¼ ç…§ç‰‡
const [photoHistory, setPhotoHistory] = useState<string[]>([])
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **å®Œæ•´é›†æˆæŒ‡å—**ï¼š`ESP32_CAM_INTEGRATION_ZH.md`
- **AP æ¨¡å¼å·¥ä½œæµç¨‹**ï¼š`ESP32_AP_MODE_WORKFLOW_ZH.md`
- **WiFi ç®¡ç†å·¥å…·**ï¼š`manage-esp32-wifi.sh`
- **æµ‹è¯•è„šæœ¬**ï¼š`test-esp32-cam.js`

---

## âœ… æ€»ç»“

ç°åœ¨ä½ å¯ä»¥ï¼š

1. âœ… **å¯åŠ¨å‰åç«¯**ï¼ˆä»»ä½• WiFiï¼‰
2. âœ… **åˆ‡æ¢åˆ° ESP32 WiFi**
3. âœ… **è®¿é—® localhost:5173**ï¼ˆæ­£å¸¸å·¥ä½œï¼‰
4. âœ… **åœ¨ç½‘é¡µä¸Šç›´æ¥æ‹æ‘„ç…§ç‰‡**ï¼ˆå…¨åŠŸèƒ½ç•Œé¢ï¼‰
5. âœ… **åˆ‡å›å®¶åº­ WiFi ç»§ç»­å¼€å‘**

**ä¸€åˆ‡éƒ½å·²å°±ç»ªï¼** ğŸ‰

ç«‹å³æµ‹è¯•ï¼š
```bash
cd /Users/meaqua/Desktop/EE3070/smart-cat-home
npm run dev
```

ç„¶åè¿æ¥åˆ° ESP32 WiFiï¼Œæ‰“å¼€ http://localhost:5173

äº«å—ä½ çš„ ESP32 æ‘„åƒå¤´å§ï¼ğŸ“·âœ¨
